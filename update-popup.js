(function() { 'use strict'; const CONFIG = { currentVersion: '1.2.2', storageKey: 'intranet_last_version_seen', popupDelay: 500 }; const updateContent = { title: 'ðŸŽ‰ NouveautÃ©s de la version ' + CONFIG.currentVersion, updates: [ { icon: 'âš¡', title: 'AmÃ©liorations', description: 'Corrections de bugs et optimisations diverses.' }, { icon: 'ðŸ“', title: 'Gestions PDS', description: 'Ajustement de la gestion des PDS.' }, { icon: 'ðŸ—“ï¸', title: 'Stockage', description: 'Ajustement et optimisation su stockage de sauvgarde.' }, ], footer: 'Par goodging33_dev' }; function shouldShowPopup() { const lastVersionSeen = localStorage.getItem(CONFIG.storageKey); return lastVersionSeen !== CONFIG.currentVersion; } function markAsViewed() { localStorage.setItem(CONFIG.storageKey, CONFIG.currentVersion); } function createPopup() { const overlay = document.createElement('div'); overlay.id = 'update-popup-overlay'; overlay.style.cssText = ` position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.7); z-index: 9999; display: flex; justify-content: center; align-items: center; animation: fadeIn 0.3s ease; `; const popup = document.createElement('div'); popup.id = 'update-popup'; popup.style.cssText = ` background-color: rgb(45, 45, 45); border: 2px solid rgb(245, 147, 20); border-radius: 15px; padding: 30px; max-width: 500px; width: 90%; max-height: 80vh; overflow-y: auto; box-shadow: 0 0 30px rgba(245, 147, 20, 0.5); animation: slideIn 0.4s ease; color: white; `; const title = document.createElement('h2'); title.textContent = updateContent.title; title.style.cssText = ` color: rgb(245, 147, 20); margin-top: 0; text-align: center; font-size: 1.5em; `; const updatesList = document.createElement('div'); updatesList.style.cssText = ` margin: 20px 0; `; updateContent.updates.forEach(update => { const updateItem = document.createElement('div'); updateItem.style.cssText = ` background-color: rgb(55, 55, 55); border-left: 3px solid rgb(245, 147, 20); padding: 15px; margin-bottom: 15px; border-radius: 5px; `; updateItem.innerHTML = ` <div style="font-size: 1.3em; margin-bottom: 5px;"> ${update.icon} <strong>${update.title}</strong> </div> <div style="color: rgb(200, 200, 200); font-size: 0.95em;"> ${update.description} </div> `; updatesList.appendChild(updateItem); }); const footer = document.createElement('p'); footer.textContent = updateContent.footer; footer.style.cssText = ` text-align: center; color: rgb(180, 180, 180); font-style: italic; margin-bottom: 20px; `; const closeButton = document.createElement('button'); closeButton.textContent = 'J\'ai compris !'; closeButton.style.cssText = ` background-color: rgb(245, 147, 20); color: rgb(37, 37, 37); border: none; border-radius: 10px; padding: 12px 30px; font-size: 1.1em; font-weight: bold; cursor: pointer; width: 100%; transition: all 0.3s ease; `; closeButton.onmouseover = function() { this.style.boxShadow = '0 0 20px rgba(245, 147, 20, 0.8)'; this.style.transform = 'translateY(-2px)'; }; closeButton.onmouseout = function() { this.style.boxShadow = 'none'; this.style.transform = 'translateY(0)'; }; closeButton.onclick = function() { markAsViewed(); overlay.style.animation = 'fadeOut 0.3s ease'; setTimeout(() => { document.body.removeChild(overlay); }, 300); }; popup.appendChild(title); popup.appendChild(updatesList); popup.appendChild(footer); popup.appendChild(closeButton); overlay.appendChild(popup); const style = document.createElement('style'); style.textContent = ` @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } } @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } } @keyframes slideIn { from { transform: translateY(-50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } } #update-popup::-webkit-scrollbar { width: 8px; } #update-popup::-webkit-scrollbar-track { background: rgb(55, 55, 55); border-radius: 10px; } #update-popup::-webkit-scrollbar-thumb { background: rgb(245, 147, 20); border-radius: 10px; } `; document.head.appendChild(style); document.body.appendChild(overlay); } function init() { if (document.readyState === 'loading') { document.addEventListener('DOMContentLoaded', init); return; } if (shouldShowPopup()) { setTimeout(createPopup, CONFIG.popupDelay); } } init(); })();
